function XSLTransformer(b,j){var i=j;var c=null;var f=null;var e=b;var h=0;ker.loadMan.acquire();ker.loadURL(Env.url+"/xsl/"+b,a);if(f==null){ker.loadURL(Env.url+"/xsl/"+b,a)}ker.loadMan.release();function a(k){if(k.responseXML!=undefined){try{f=k.responseXML;if(window.ActiveXObject==null){c=new XSLTProcessor();c.importStylesheet(f)}}catch(l){alert("error on : "+Env.url+"/xsl/"+b+"\n"+k.responseText+" "+k.responseXML+" "+l)}}}this.transform=function(k){var n=g(k);if(window.ActiveXObject){try{var o=n.transformNode(f);var l=new ActiveXObject("Microsoft.XMLDOM");l.async="false";if(l.loadXML(o)==false){throw"Parse error for:\n\n"+o}return xml.convert(l)}catch(m){throw"Cannot transform with stylesheet.\nFile : "+e}}else{return c.transformToDocument(n)}};this.transformToText=function(k){var m=g(k);if(window.ActiveXObject){try{return m.transformNode(f)}catch(l){throw"Cannot transform with stylesheet.\nFile : "+e}}else{return xml.toString(c.transformToDocument(m))}};function g(m){var k=(!i)?Sarissa.getDomDocument().createElement("strings"):i.getNode();var n=Sarissa.getDomDocument();var l=n.createElement("root");n.appendChild(l);l.appendChild(m.cloneNode(true));l.appendChild(d(n));l.appendChild(k.cloneNode(true));return n}function d(o){var l=o.createElement("env");var m=o.createElement("url");var p=o.createElement("locUrl");var n=o.createElement("locService");var k=o.createElement("language");l.appendChild(m);l.appendChild(p);l.appendChild(n);l.appendChild(k);m.appendChild(o.createTextNode(Env.url));p.appendChild(o.createTextNode(Env.locUrl));n.appendChild(o.createTextNode(Env.locService));k.appendChild(o.createTextNode(Env.lang));return l}};