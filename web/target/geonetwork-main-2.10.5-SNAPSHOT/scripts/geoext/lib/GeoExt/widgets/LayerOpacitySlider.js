Ext.namespace("GeoExt");GeoExt.LayerOpacitySlider=Ext.extend(Ext.Slider,{layer:null,complementaryLayer:null,delay:5,changeVisibilityDelay:5,aggressive:false,changeVisibility:false,value:null,constructor:function(a){if(a.layer){if(a.layer instanceof OpenLayers.Layer){this.layer=a.layer}else{if(a.layer instanceof GeoExt.data.LayerRecord){this.layer=a.layer.get("layer")}}if(a.complementaryLayer instanceof OpenLayers.Layer){this.complementaryLayer=a.complementaryLayer}else{if(a.complementaryLayer instanceof GeoExt.data.LayerRecord){this.complementaryLayer=a.complementaryLayer.get("layer")}}delete a.layer;delete a.complementaryLayer}GeoExt.LayerOpacitySlider.superclass.constructor.call(this,a)},initComponent:function(){if(this.layer&&this.layer.opacity!==null){this.value=parseInt(this.layer.opacity*(this.maxValue-this.minValue))}else{if(this.value==null){this.value=this.maxValue}}GeoExt.LayerOpacitySlider.superclass.initComponent.call(this);if(this.changeVisibility&&this.layer&&(this.layer.opacity==0||this.value==this.minValue)){this.layer.setVisibility(false)}if(this.complementaryLayer&&((this.layer&&this.layer.opacity==1)||(this.value==this.maxValue))){this.complementaryLayer.setVisibility(false)}if(this.aggressive===true){this.on("change",this.changeLayerOpacity,this,{buffer:this.delay})}else{this.on("changecomplete",this.changeLayerOpacity,this)}if(this.changeVisibility===true){this.on("change",this.changeLayerVisibility,this,{buffer:this.changeVisibilityDelay})}if(this.complementaryLayer){this.on("change",this.changeComplementaryLayerVisibility,this,{buffer:this.changeVisibilityDelay})}},changeLayerOpacity:function(a,b){if(this.layer){this.layer.setOpacity(b/100)}},changeLayerVisibility:function(b,c){var a=this.layer.getVisibility();if(c==this.minValue&&a===true){this.layer.setVisibility(false)}else{if(c>this.minValue&&a==false){this.layer.setVisibility(true)}}},changeComplementaryLayerVisibility:function(b,c){var a=this.complementaryLayer.getVisibility();if(c==this.maxValue&&a===true){this.complementaryLayer.setVisibility(false)}else{if(c<this.maxValue&&a==false){this.complementaryLayer.setVisibility(true)}}},addToMapPanel:function(a){this.on({render:function(){var b=this.getEl();b.setStyle({position:"absolute",zIndex:a.map.Z_INDEX_BASE.Control});b.on({mousedown:this.stopMouseEvents,click:this.stopMouseEvents})},scope:this})},removeFromMapPanel:function(a){var b=this.getEl();b.un({mousedown:this.stopMouseEvents,click:this.stopMouseEvents,scope:this})},stopMouseEvents:function(a){a.stopEvent()}});Ext.reg("gx_opacityslider",GeoExt.LayerOpacitySlider);