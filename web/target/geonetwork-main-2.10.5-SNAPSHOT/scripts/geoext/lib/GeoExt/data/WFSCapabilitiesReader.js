Ext.namespace("GeoExt.data");GeoExt.data.WFSCapabilitiesReader=function(a,b){a=a||{};if(!a.format){a.format=new OpenLayers.Format.WFSCapabilities()}if(!(typeof b==="function")){b=GeoExt.data.LayerRecord.create(b||a.fields||[{name:"name",type:"string"},{name:"abstract",type:"string"}])}GeoExt.data.WFSCapabilitiesReader.superclass.constructor.call(this,a,b)};Ext.extend(GeoExt.data.WFSCapabilitiesReader,Ext.data.DataReader,{read:function(a){var b=a.responseXML;if(!b||!b.documentElement){b=a.responseText}return this.readRecords(b)},readRecords:function(f){if(typeof f==="string"||f.nodeType){f=this.meta.format.read(f)}var b=[],h,c,d,k,m;var a=f.featureTypeList.featureTypes;var g={url:f.capability.request.getfeature.href.post};for(var e=0,j=a.length;e<j;e++){h=a[e];if(h.name){d=h.name.split(":");if(d.length>1){m={featureType:d[1],featurePrefix:d[0]}}else{m={featureType:d[0],featurePrefix:null}}if(this.meta.protocolOptions){Ext.apply(m,this.meta.protocolOptions,g)}else{Ext.apply(m,{},g)}k={protocol:new OpenLayers.Protocol.WFS(m),strategies:[new OpenLayers.Strategy.Fixed()]};if(this.meta.layerOptions){Ext.apply(k,this.meta.layerOptions)}c=new OpenLayers.Layer.Vector(h.title||h.name,k);b.push(new this.recordType(Ext.apply(h,{layer:c}),c.id))}}return{totalRecords:b.length,success:true,records:b}}});