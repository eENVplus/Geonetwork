Ext.namespace("GeoNetwork","GeoNetwork.WMC");GeoNetwork.WMC=function(){return{loadWmc:function(f,a){try{var e=f.layers;for(var b=e.length-1;b>0;b--){if(!e[b].isBaseLayer){f.removeLayer(e[b])}}Ext.getCmp("toctree").getSelectionModel().clearSelections();var d=new OpenLayers.Format.WMC({layerOptions:{buffer:0}});f=d.read(a,{map:f})}catch(c){Ext.MessageBox.alert(OpenLayers.i18n("selectWMCFile.errorLoadingWMC"))}},mergeWmc:function(d,a){try{var c=new OpenLayers.Format.WMC({layerOptions:{buffer:0}});d=c.read(a,{map:d})}catch(b){Ext.MessageBox.alert(OpenLayers.i18n("selectWMCFile.errorLoadingWMC"))}},saveContext:function(b){var a=new OpenLayers.Format.WMC();OpenLayers.Request.POST({url:"../../wmc/create.wmc",data:a.write(b),success:this.onSaveContextSuccess,failure:this.onSaveContextFailure})},onSaveContextSuccess:function(a){var b=a.responseText;var c=Ext.decode(b);if(c.success){window.location=c.url}else{this.onSaveContextFailure()}},onSaveContextFailure:function(a,b){Ext.MessageBox.show({icon:Ext.MessageBox.ERROR,title:OpenLayers.i18n("saveWMCFile.windowTitle"),msg:OpenLayers.i18n("saveWMCFile.errorSaveWMC"),buttons:Ext.MessageBox.OK})}}};GeoNetwork.WMCManager=new GeoNetwork.WMC();