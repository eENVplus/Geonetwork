Ext.namespace("GeoNetwork");GeoNetwork.LoadWmcWindow=function(a){Ext.apply(this,a);GeoNetwork.LoadWmcWindow.superclass.constructor.call(this)};Ext.extend(GeoNetwork.LoadWmcWindow,GeoNetwork.BaseWindow,{initComponent:function(){GeoNetwork.LoadWmcWindow.superclass.initComponent.call(this);Ext.QuickTips.init();this.title=this.title||OpenLayers.i18n("selectWMCFile.windowTitle");this.width=385;this.resizable=false;this.charset="UTF-8";var a=new Ext.FormPanel({renderTo:"form_wmc",fileUpload:true,width:360,autoheight:true,layout:"fit",bodyStyle:"padding: 10px 10px 0 10px;",labelWidth:0,plain:true,frame:true,border:false,defaults:{anchor:"90%",msgTarget:"side",allowBlank:false},items:[{xtype:"fileuploadfield",id:"form-file",emptyText:OpenLayers.i18n("selectWMCFile"),hideLabel:true,buttonText:"",name:"Fileconten",buttonCfg:{text:"",iconCls:"selectfile"}}],buttons:[{text:OpenLayers.i18n("selectWMCFile.loadButtonText"),scope:this,handler:function(){if(a.getForm().isValid()){a.getForm().submit({url:"../../wmc/load.wmc",success:this.onSuccessLoad,failure:this.onFailure,scope:this})}}},{text:OpenLayers.i18n("selectWMCFile.mergeButtonText"),scope:this,handler:function(){if(a.getForm().isValid()){a.getForm().submit({url:"../../wmc/load.wmc",success:this.onSuccessMerge,failure:this.onFailure,scope:this})}}}]});this.add(a);this.doLayout()},onSuccessLoad:function(c,d){var b=d.response.responseText;var e=Ext.decode(b);if(e.success){var a=OpenLayers.Function.bind(this.parseWMCLoad,this);OpenLayers.loadURL(e.url,null,null,a)}else{this.onAjaxFailure()}},onSuccessMerge:function(c,d){var b=d.response.responseText;var e=Ext.decode(b);if(e.success){var a=OpenLayers.Function.bind(this.parseWMCMerge,this);OpenLayers.loadURL(e.url,null,null,a)}else{this.onAjaxFailure()}},onFailure:function(a,b){Ext.MessageBox.show({icon:Ext.MessageBox.ERROR,title:OpenLayers.i18n("errorTitle"),msg:OpenLayers.i18n("InvalidWMC"),buttons:Ext.MessageBox.OK})},parseWMCLoad:function(a){GeoNetwork.WMCManager.loadWmc(this.map,a.responseText);Ext.WindowMgr.getActive().close()},parseWMCMerge:function(a){GeoNetwork.WMCManager.mergeWmc(this.map,a.responseText);Ext.WindowMgr.getActive().close()}});