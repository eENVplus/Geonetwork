(function(){var e=window.XMLHttpRequest;var a=!!window.controllers,h=window.document.all&&!window.opera,i=h&&window.navigator.userAgent.match(/MSIE ([\.0-9]+)/)&&RegExp.$1==7;function c(){this._object=e&&!i?new e:new window.ActiveXObject("Microsoft.XMLHTTP");this._listeners=[]}if(a&&e.wrapped){c.wrapped=e.wrapped}c.UNSENT=0;c.OPENED=1;c.HEADERS_RECEIVED=2;c.LOADING=3;c.DONE=4;c.prototype.readyState=c.UNSENT;c.prototype.responseText="";c.prototype.responseXML=null;c.prototype.status=0;c.prototype.statusText="";c.prototype.onreadystatechange=null;c.onreadystatechange=null;c.onopen=null;c.onsend=null;c.onabort=null;c.prototype.open=function(m,p,l,q,k){delete this._headers;if(arguments.length<3){l=true}this._async=l;var o=this,n=this.readyState,j;if(h&&l){j=function(){if(n!=c.DONE){d(o);o.abort()}};window.attachEvent("onunload",j)}if(c.onopen){c.onopen.apply(this,arguments)}if(arguments.length>4){this._object.open(m,p,l,q,k)}else{if(arguments.length>3){this._object.open(m,p,l,q)}else{this._object.open(m,p,l)}}if(!a&&!h){this.readyState=c.OPENED;b(this)}this._object.onreadystatechange=function(){if(a&&!l){return}o.readyState=o._object.readyState;f(o);if(o._aborted){o.readyState=c.UNSENT;return}if(o.readyState==c.DONE){d(o);if(h&&l){window.detachEvent("onunload",j)}}if(n!=o.readyState){b(o)}n=o.readyState}};c.prototype.send=function(j){if(c.onsend){c.onsend.apply(this,arguments)}if(j&&j.nodeType){j=window.XMLSerializer?new window.XMLSerializer().serializeToString(j):j.xml;if(!this._headers["Content-Type"]){this._object.setRequestHeader("Content-Type","application/xml")}}this._object.send(j);if(a&&!this._async){this.readyState=c.OPENED;f(this);while(this.readyState<c.DONE){this.readyState++;b(this);if(this._aborted){return}}}};c.prototype.abort=function(){if(c.onabort){c.onabort.apply(this,arguments)}if(this.readyState>c.UNSENT){this._aborted=true}this._object.abort();d(this)};c.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders()};c.prototype.getResponseHeader=function(j){return this._object.getResponseHeader(j)};c.prototype.setRequestHeader=function(j,k){if(!this._headers){this._headers={}}this._headers[j]=k;return this._object.setRequestHeader(j,k)};c.prototype.addEventListener=function(m,l,k){for(var j=0,n;n=this._listeners[j];j++){if(n[0]==m&&n[1]==l&&n[2]==k){return}}this._listeners.push([m,l,k])};c.prototype.removeEventListener=function(m,l,k){for(var j=0,n;n=this._listeners[j];j++){if(n[0]==m&&n[1]==l&&n[2]==k){break}}if(n){this._listeners.splice(j,1)}};c.prototype.dispatchEvent=function(k){var l={type:k.type,target:this,currentTarget:this,eventPhase:2,bubbles:k.bubbles,cancelable:k.cancelable,timeStamp:k.timeStamp,stopPropagation:function(){},preventDefault:function(){},initEvent:function(){}};if(l.type=="readystatechange"&&this.onreadystatechange){(this.onreadystatechange.handleEvent||this.onreadystatechange).apply(this,[l])}for(var j=0,m;m=this._listeners[j];j++){if(m[0]==l.type&&!m[2]){(m[1].handleEvent||m[1]).apply(this,[l])}}};c.prototype.toString=function(){return"[object XMLHttpRequest]"};c.toString=function(){return"[XMLHttpRequest]"};function b(j){if(c.onreadystatechange){c.onreadystatechange.apply(j)}j.dispatchEvent({type:"readystatechange",bubbles:false,cancelable:false,timeStamp:new Date+0})}function g(l){var k=l.responseXML,j=l.responseText;if(h&&j&&k&&!k.documentElement&&l.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/)){k=new window.ActiveXObject("Microsoft.XMLDOM");k.async=false;k.validateOnParse=false;k.loadXML(j)}if(k){if((h&&k.parseError!=0)||!k.documentElement||(k.documentElement&&k.documentElement.tagName=="parsererror")){return null}}return k}function f(j){try{j.responseText=j._object.responseText}catch(k){}try{j.responseXML=g(j._object)}catch(k){}try{j.status=j._object.status}catch(k){}try{j.statusText=j._object.statusText}catch(k){}}function d(j){j._object.onreadystatechange=new window.Function}if(!window.Function.prototype.apply){window.Function.prototype.apply=function(j,k){if(!k){k=[]}j.__func=this;j.__func(k[0],k[1],k[2],k[3],k[4]);delete j.__func}}OpenLayers.Request.XMLHttpRequest=c})();