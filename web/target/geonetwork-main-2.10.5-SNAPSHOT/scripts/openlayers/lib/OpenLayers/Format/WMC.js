OpenLayers.Format.WMC=OpenLayers.Class(OpenLayers.Format.Context,{defaultVersion:"1.1.0",getParser:function(a){var b=a||this.version||this.defaultVersion;if(!this.parser||this.parser.VERSION!=b){var c=OpenLayers.Format.WMC["v"+b.replace(/\./g,"_")];if(!c){throw"Can't find a WMC parser for version "+b}this.parser=new c(this.options)}return this.parser},layerToContext:function(a){var c=this.getParser();var b={queryable:a.queryable,visibility:a.visibility,name:a.params.LAYERS,title:a.name,metadataURL:a.metadataURL,version:a.params.VERSION,url:a.url,maxExtent:a.maxExtent,transparent:a.params.TRANSPARENT,numZoomLevels:a.numZoomLevels,units:a.units,isBaseLayer:a.isBaseLayer,opacity:a.opacity,displayInLayerSwitcher:a.displayInLayerSwitcher,singleTile:a.singleTile,tileSize:(a.singleTile||!a.tileSize)?undefined:{width:a.tileSize.w,height:a.tileSize.h},minScale:(a.options.resolutions||a.options.scales||a.options.maxResolution||a.options.minScale)?a.minScale:undefined,maxScale:(a.options.resolutions||a.options.scales||a.options.minResolution||a.options.maxScale)?a.maxScale:undefined,formats:[{value:a.params.FORMAT,current:true}],styles:[{href:a.params.SLD,body:a.params.SLD_BODY,name:a.params.STYLES||c.defaultStyleName,title:c.defaultStyleTitle,current:true}]};return b},toContext:function(f){var d={};var e=f.layers;if(f.CLASS_NAME=="OpenLayers.Map"){d.bounds=f.getExtent();d.maxExtent=f.maxExtent;d.projection=f.projection;d.size=f.getSize()}else{OpenLayers.Util.applyDefaults(d,f);if(d.layers!=undefined){delete (d.layers)}}if(d.layersContext==undefined){d.layersContext=[]}if(e!=undefined&&e instanceof Array){for(var c=0,a=e.length;c<a;c++){var b=e[c];if(b instanceof OpenLayers.Layer.WMS){d.layersContext.push(this.layerToContext(b))}}}return d},CLASS_NAME:"OpenLayers.Format.WMC"});