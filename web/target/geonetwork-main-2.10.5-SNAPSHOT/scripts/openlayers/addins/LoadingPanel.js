OpenLayers.Control.LoadingPanel=OpenLayers.Class(OpenLayers.Control,{counter:0,maximized:false,visible:true,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a])},setVisible:function(a){this.visible=a;if(a){OpenLayers.Element.show(this.div)}else{OpenLayers.Element.hide(this.div)}},getVisible:function(){return this.visible},hide:function(){this.setVisible(false)},show:function(){this.setVisible(true)},toggle:function(){this.setVisible(!this.getVisible())},addLayer:function(a){if(a.layer){a.layer.events.register("loadstart",this,this.increaseCounter);a.layer.events.register("loadend",this,this.decreaseCounter)}},setMap:function(c){OpenLayers.Control.prototype.setMap.apply(this,arguments);this.map.events.register("preaddlayer",this,this.addLayer);for(var b=0;b<this.map.layers.length;b++){var a=this.map.layers[b];a.events.register("loadstart",this,this.increaseCounter);a.events.register("loadend",this,this.decreaseCounter)}},increaseCounter:function(){this.counter++;if(this.counter>0){if(!this.maximized&&this.visible){this.maximizeControl()}}},decreaseCounter:function(){if(this.counter>0){this.counter--}if(this.counter==0){if(this.maximized&&this.visible){this.minimizeControl()}}},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);return this.div},minimizeControl:function(a){this.div.style.display="none";this.div.style.width="0px";this.div.style.height="0px";this.maximized=false;if(a!=null){OpenLayers.Event.stop(a)}},maximizeControl:function(a){var d=this.map.getSize();var b=d.w;var c=d.h;this.div.style.width=b+"px";this.div.style.height=c+"px";this.div.style.display="block";this.maximized=true;if(a!=null){OpenLayers.Event.stop(a)}},destroy:function(){if(this.map){this.map.events.unregister("preaddlayer",this,this.addLayer);if(this.map.layers){for(var b=0;b<this.map.layers.length;b++){var a=this.map.layers[b];a.events.unregister("loadstart",this,this.increaseCounter);a.events.unregister("loadend",this,this.decreaseCounter)}}}OpenLayers.Control.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.LoadingPanel"});