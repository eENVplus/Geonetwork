ker.include("harvesting/harvester.js");ker.include("harvesting/harvester-model.js");ker.include("harvesting/harvester-view.js");ker.include("harvesting/geonet/geonetwork.js");ker.include("harvesting/geonet20/geonetwork20.js");ker.include("harvesting/geoPREST/geoPREST.js");ker.include("harvesting/webdav/webdav.js");ker.include("harvesting/csw/csw.js");ker.include("harvesting/ogcwxs/ogcwxs.js");ker.include("harvesting/thredds/thredds.js");ker.include("harvesting/wfsfeatures/wfsfeatures.js");ker.include("harvesting/z3950/z3950.js");ker.include("harvesting/z3950Config/z3950Config.js");ker.include("harvesting/oaipmh/oaipmh.js");ker.include("harvesting/arcsde/arcsde.js");ker.include("harvesting/filesystem/filesystem.js");ker.include("harvesting/model.js");ker.include("harvesting/view.js");ker.include("harvesting/util.js");var harvesting=null;function init(){harvesting=new Harvesting();ker.loadMan.wait(harvesting)}function Harvesting(){var o=new XMLLoader(Env.locUrl+"/xml/harvesting.xml");var c=new Model(o);var r=new View(o);var e=new Geonetwork(o);var y=new Geonetwork20(o);var B=new GeoPREST(o);var j=new WebDav(o);var k=new Csw(o);var m=new Z3950(o);var H=new OaiPmh(o);var b=new OgcWxs(o);var n=new Arcsde(o);var u=new Thredds(o);var t=new WfsFeatures(o);var h=new Filesystem(o);var C=new Z3950Config(o);this.geonet=e;this.geonet20=y;this.geoPREST=B;this.webdav=j;this.csw=k;this.z3950=m;this.z3950Config=C;this.oaipmh=H;this.ogcwxs=b;this.thredds=u;this.wfsfeatures=t;this.arcsde=n;this.filesystem=h;this.init=A;this.refresh=d;this.remove=I;this.start=f;this.stop=z;this.run=v;this.edit=x;this.update=i;this.show=F;this.newNode=a;this.history=q;this.clone=E;this.cloneCB=p;function A(){r.register(e);r.register(y);r.register(B);r.register(j);r.register(k);r.register(b);r.register(u);r.register(m);r.register(H);r.register(t);r.register(n);r.register(h);r.register(C);r.show(SHOW.LIST);d()}function d(){r.removeAll();c.getNodes(ker.wrap(this,G))}function G(K){var J=xml.children(K);for(var L=0;L<J.length;L++){r.append(J[L])}}function I(){var J=r.getIdList();if(J.length==0){alert(o.getText("pleaseSelect"))}else{if(confirm(o.getText("confirmRemove"))==false){return}c.removeNodes(J,ker.wrap(this,w))}}function w(K){for(var J=0;J<K.length;J++){r.remove(K[J].ID)}}function f(){var J=r.getIdList();if(J.length==0){alert(o.getText("pleaseSelect"))}else{c.startNodes(J,ker.wrap(this,g))}}function g(L){for(var K=0;K<L.length;K++){var M=L[K].ID;var J=L[K].STATUS;if(J=="ok"||J=="already-active"){r.unselect(M);r.setStarted(M)}}}function z(){var J=r.getIdList();if(J.length==0){alert(o.getText("pleaseSelect"))}else{c.stopNodes(J,ker.wrap(this,D))}}function D(L){for(var K=0;K<L.length;K++){var M=L[K].ID;var J=L[K].STATUS;if(J=="ok"||J=="already-inactive"){r.unselect(M);r.setStopped(M)}}}function v(){var J=r.getIdList();if(J.length==0){alert(o.getText("pleaseSelect"))}else{c.runNodes(J,ker.wrap(this,l))}}function l(L){for(var K=0;K<L.length;K++){var M=L[K].ID;var J=L[K].STATUS;if(J=="ok"||J=="already-running"){r.unselect(M);r.setRunning(M)}}}function E(K){var J=r.getIdList();if(J.length==0){alert(o.getText("pleaseSelect"));return}if(J.length>1){alert(o.getText("onlyOnePlease"));return}c.cloneNode(J,ker.wrap(this,p))}function p(J){var K=r.append(J);harvesting.edit(K)}function x(J){c.getNode(J,ker.wrap(r,r.edit))}function q(J){var K=window.location.href;if(K.indexOf("modal")!=-1){J+="&modal"}load(J)}function i(){var J=r.getUpdateRequest();if(J==null){return}if(r.isAdding()){c.addNode(J,ker.wrap(this,s))}else{c.updateNode(J,ker.wrap(this,s))}}function s(J){if(r.isAdding()){r.append(J)}else{r.refresh(J)}r.show(SHOW.LIST)}function F(J){r.show(J)}function a(){r.newNode()}};