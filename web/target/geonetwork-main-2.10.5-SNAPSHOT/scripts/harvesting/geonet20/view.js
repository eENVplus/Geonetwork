gn20.View=function(p){HarvesterView.call(this);var g=new XSLTransformer("harvesting/geonet20/client-search-row.xsl",p);var q=new XSLTransformer("harvesting/geonet20/client-result-tip.xsl",p);var k=p;var c=new Validator(k);var b=null;this.setPrefix("gn20");this.setResultTransf(q);this.init=n;this.setEmpty=o;this.setData=m;this.getData=h;this.isDataValid=f;this.getSiteId=i;this.clearSiteId=l;this.addEmptySearch=j;this.addSearch=e;this.removeSearch=a;this.removeAllSearch=d;this.removeAllGroupRows=function(){};this.unselectCategories=function(){};function n(){c.add([{id:"gn20.name",type:"length",minSize:1,maxSize:200},{id:"gn20.host",type:"length",minSize:1,maxSize:200},{id:"gn20.host",type:"url"},{id:"gn20.username",type:"length",minSize:0,maxSize:200},{id:"gn20.password",type:"length",minSize:0,maxSize:200}]);b=new Shower("gn20.useAccount","gn20.account")}function o(){this.setEmptyCommon();d();$("gn20.host").value="";l();b.update()}function m(u){this.setDataCommon(u);var r=u.getElementsByTagName("site")[0];var t=u.getElementsByTagName("searches")[0];hvutil.setOption(r,"host","gn20.host");d();var v=t.getElementsByTagName("search");for(var s=0;s<v.length;s++){e(v[s])}l();b.update()}function h(){var u=this.getDataCommon();u.HOST=$F("gn20.host");var t=[];var s=xml.children($("gn20.searches"));for(var r=0;r<s.length;r++){var v=s[r];t.push({TEXT:xml.getElementById(v,"gn20.text").value,TITLE:xml.getElementById(v,"gn20.title").value,ABSTRACT:xml.getElementById(v,"gn20.abstract").value,KEYWORDS:xml.getElementById(v,"gn20.keywords").value,DIGITAL:xml.getElementById(v,"gn20.digital").checked,HARDCOPY:xml.getElementById(v,"gn20.hardcopy").checked,SITE_ID:v.getAttribute("id")})}u.SEARCH_LIST=t;return u}function f(){if(!c.validate()){return false}return this.isDataValidCommon()}function i(){return $F("gn20.siteId")}function l(){$("gn20.siteId").value=""}function j(t){var s=Sarissa.getDomDocument();var u=s.createElement("search");var r=s.createElement("siteId");s.appendChild(u);u.appendChild(r);r.appendChild(s.createTextNode(t));e(u)}function e(t){var s=xml.evalXPath(t,"siteId");var r=g.transformToText(t);var u=xml.getElementById($("gn20.searches"),s);if(u!=null){return}new Insertion.Bottom("gn20.searches",r);c.add([{id:"gn20.text",type:"length",minSize:0,maxSize:200},{id:"gn20.title",type:"length",minSize:0,maxSize:200},{id:"gn20.abstract",type:"length",minSize:0,maxSize:200},{id:"gn20.keywords",type:"length",minSize:0,maxSize:200}],s)}function a(r){c.removeByParent(r);Element.remove(r)}function d(){$("gn20.searches").innerHTML="";c.removeByParent()}};