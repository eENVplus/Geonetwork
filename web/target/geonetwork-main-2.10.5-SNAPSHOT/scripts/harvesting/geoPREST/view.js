geoPREST.View=function(c){HarvesterView.call(this);var f=new XSLTransformer("harvesting/geoPREST/client-search-row.xsl",c);var a=new XSLTransformer("harvesting/geoPREST/client-privil-row.xsl",c);var l=new XSLTransformer("harvesting/geoPREST/client-result-tip.xsl",c);var j=c;var m=new Validator(j);var n=null;var t=0;this.setPrefix("geoPREST");this.setPrivilTransf(a);this.setResultTransf(l);this.init=r;this.setEmpty=s;this.setData=g;this.getData=k;this.isDataValid=e;this.clearIcons=i;this.addIcon=q;this.addEmptySearch=o;this.removeSearch=h;Event.observe("geoPREST.icon","change",ker.wrap(this,d));function r(){m.add([{id:"geoPREST.name",type:"length",minSize:1,maxSize:200},{id:"geoPREST.baseUrl",type:"length",minSize:1,maxSize:200},{id:"geoPREST.baseUrl",type:"url"},{id:"geoPREST.username",type:"length",minSize:0,maxSize:200},{id:"geoPREST.password",type:"length",minSize:0,maxSize:200}]);n=new Shower("geoPREST.useAccount","geoPREST.account")}function s(){this.setEmptyCommon();p();$("geoPREST.baseUrl").value="";var v=$("geoPREST.icon").options;for(var u=0;u<v.length;u++){if(v[u].value=="default.gif"){v[u].selected=true;break}}n.update();d()}function g(x){this.setDataCommon(x);var u=x.getElementsByTagName("site")[0];var w=x.getElementsByTagName("searches")[0];hvutil.setOption(u,"baseUrl","geoPREST.baseUrl");hvutil.setOption(u,"icon","geoPREST.icon");var y=w.getElementsByTagName("search");p();for(var v=0;v<y.length;v++){b(y[v])}this.removeAllGroupRows();this.addGroupRows(x);this.unselectCategories();this.selectCategories(x);n.update();d()}function k(){var x=this.getDataCommon();x.BASE_URL=$F("geoPREST.baseUrl");x.ICON=$F("geoPREST.icon");var w=[];var v=xml.children($("geoPREST.searches"));for(var u=0;u<v.length;u++){var y=v[u];w.push({ANY_TEXT:xml.getElementById(y,"geoPREST.anytext").value})}x.SEARCH_LIST=w;x.PRIVILEGES=this.getPrivileges();x.CATEGORIES=this.getSelectedCategories();return x}function e(){if(!m.validate()){return false}return this.isDataValidCommon()}function i(){$("geoPREST.icon").options.length=0}function q(u){gui.addToSelect("geoPREST.icon",u,u)}function d(){var u=$F("geoPREST.icon");var v=$("geoPREST.icon.image");v.setAttribute("src",Env.url+"/images/harvesting/"+u)}function o(){var v=Sarissa.getDomDocument();var u=v.createElement("search");b(u)}function b(v){var w=""+t++;v.setAttribute("id",w);var u=f.transformToText(v);new Insertion.Bottom("geoPREST.searches",u);m.add([{id:"geoPREST.anytext",type:"length",minSize:0,maxSize:200}],w)}function h(u){m.removeByParent(u);Element.remove(u)}function p(){$("geoPREST.searches").innerHTML="";m.removeByParent()}};